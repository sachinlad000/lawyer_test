---
/**
 * Blog Post Template
 * ==================
 * Individual blog post page with dynamic routing.
 * 
 * For production, use Astro Content Collections.
 */

import Layout from '../../layouts/Layout.astro';
import { Calendar, Clock, User, Tag, ArrowLeft } from '@lucide/astro';
import { blogPosts, type BlogPost } from '../../data/blogPosts';

// Required for static builds with dynamic routes
export function getStaticPaths() {
  return blogPosts.map(post => ({
    params: { slug: post.slug },
    props: { post }
  }));
}

interface Props {
  post: BlogPost;
}

// Get the post from props
const { post } = Astro.props;

const formatDate = (dateStr: string) => {
  return new Date(dateStr).toLocaleDateString('en-IN', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
};

// SEO Schema
const articleSchema = {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": post.title,
  "description": post.excerpt,
  "datePublished": post.date,
  "dateModified": post.date,
  "author": {
    "@type": "Person",
    "name": post.author.name
  },
  "publisher": {
    "@type": "Organization",
    "name": "Advocate Sharma & Associates",
    "url": "https://yourdomain.com"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": `https://yourdomain.com/blog/${post.slug}`
  }
};

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://yourdomain.com" },
    { "@type": "ListItem", "position": 2, "name": "Blog", "item": "https://yourdomain.com/blog" },
    { "@type": "ListItem", "position": 3, "name": post.title, "item": `https://yourdomain.com/blog/${post.slug}` }
  ]
};
---

<Layout 
  title={post.title}
  description={post.excerpt}
  keywords={`${post.category}, legal guide, advocate, lawyer India`}
>
  <Fragment slot="head">
    <script type="application/ld+json" set:html={JSON.stringify(articleSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
  </Fragment>

  <!-- Page Header -->
  <header class="post-header">
    <div class="container">
      <nav class="breadcrumb">
        <a href="/">Home</a>
        <span>/</span>
        <a href="/blog">Blog</a>
        <span>/</span>
        <span>{post.category}</span>
      </nav>
      
      <span class="post-category">{post.category}</span>
      <h1 class="post-title">{post.title}</h1>
      
      <div class="post-meta">
        <span class="meta-item">
          <User size={18} />
          {post.author.name}
        </span>
        <span class="meta-item">
          <Calendar size={18} />
          {formatDate(post.date)}
        </span>
        <span class="meta-item">
          <Clock size={18} />
          {post.readTime}
        </span>
      </div>
    </div>
  </header>

  <!-- Post Content -->
  <article class="post-content section-padding">
    <div class="container">
      <div class="post-grid">
        <!-- Main Content -->
        <main class="content-main">
          <!-- Featured Image -->
          <div class="featured-image">
            <div class="image-placeholder">
              <span class="placeholder-icon">ðŸ“·</span>
              <span class="placeholder-text">Featured Image (1200x630px)</span>
            </div>
          </div>

          <!-- Article Content -->
          <div class="article-content" set:html={post.content} />

          <!-- Tags -->
          <div class="post-tags">
            <Tag size={18} />
            <a href={`/blog?category=${post.category.toLowerCase().replace(' ', '-')}`}>{post.category}</a>
            <a href="/blog?tag=legal-guide">Legal Guide</a>
          </div>

          <!-- Share -->
          <div class="share-section">
            <span class="share-label">Share this article:</span>
            <div class="share-buttons">
              <a href="#" class="share-btn facebook" aria-label="Share on Facebook">FB</a>
              <a href="#" class="share-btn twitter" aria-label="Share on Twitter">X</a>
              <a href="#" class="share-btn linkedin" aria-label="Share on LinkedIn">in</a>
              <a href="#" class="share-btn whatsapp" aria-label="Share on WhatsApp">WA</a>
            </div>
          </div>

          <!-- Back to Blog -->
          <a href="/blog" class="back-link">
            <ArrowLeft size={18} />
            Back to Blog
          </a>
        </main>

        <!-- Sidebar -->
        <aside class="post-sidebar">
          <!-- Author -->
          <div class="sidebar-widget author-widget">
            <h3 class="widget-title">About the Author</h3>
            <div class="author-box">
              <div class="author-avatar">
                <User size={28} />
              </div>
              <div class="author-info">
                <span class="author-name">{post.author.name}</span>
                <span class="author-role">{post.author.role}</span>
                <p class="author-bio">{post.author.bio}</p>
              </div>
            </div>
          </div>

          <!-- CTA -->
          <div class="sidebar-cta">
            <h3>Related to Your Situation?</h3>
            <p>Get personalized legal advice.</p>
            <a href="/contact" class="btn btn-accent">Free Consultation</a>
          </div>

          <!-- Related Posts -->
          <div class="sidebar-widget">
            <h3 class="widget-title">Related Articles</h3>
            <ul class="related-list">
              {post.relatedPosts.map((related) => (
                <li>
                  <a href={`/blog/${related.slug}`}>{related.title}</a>
                </li>
              ))}
            </ul>
          </div>
        </aside>
      </div>
    </div>
  </article>
</Layout>

<style>
  /* Post Header */
  .post-header {
    background: linear-gradient(135deg, var(--color-primary-900) 0%, var(--color-primary-700) 100%);
    color: white;
    padding: 3rem 0 4rem;
    text-align: center;
  }
  
  .breadcrumb {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    font-size: 0.875rem;
  }
  
  .breadcrumb a { color: rgba(255, 255, 255, 0.7); }
  .breadcrumb a:hover { color: var(--color-accent-500); }
  .breadcrumb span { color: rgba(255, 255, 255, 0.5); }
  .breadcrumb span:last-child { color: var(--color-accent-500); }
  
  .post-category {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    background: var(--color-accent-500);
    color: var(--color-primary-900);
    font-size: 0.875rem;
    font-weight: 600;
    border-radius: 9999px;
    margin-bottom: 1rem;
  }
  
  .post-title {
    color: white;
    font-size: clamp(1.5rem, 4vw, 2.5rem);
    max-width: 900px;
    margin: 0 auto 1.5rem;
    line-height: 1.3;
  }
  
  .post-meta {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 1.5rem;
  }
  
  .meta-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.9375rem;
  }
  
  /* Post Content */
  .post-content { background: white; }
  
  .post-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 3rem;
  }
  
  @media (min-width: 1024px) {
    .post-grid { grid-template-columns: 1fr 320px; }
  }
  
  .featured-image {
    aspect-ratio: 16/9;
    border-radius: 1rem;
    overflow: hidden;
    margin-bottom: 2rem;
  }
  
  .image-placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--color-neutral-200) 0%, var(--color-neutral-300) 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: var(--color-neutral-500);
  }
  
  .placeholder-icon { font-size: 3rem; }
  .placeholder-text { margin-top: 0.5rem; }
  
  /* Article Content Styles */
  .article-content {
    font-size: 1.0625rem;
    line-height: 1.8;
    color: var(--color-neutral-700);
  }
  
  .article-content :global(p) { margin-bottom: 1.5rem; }
  .article-content :global(p.lead) {
    font-size: 1.25rem;
    color: var(--color-neutral-600);
    border-left: 4px solid var(--color-accent-500);
    padding-left: 1.5rem;
    margin-bottom: 2rem;
  }
  
  .article-content :global(h2) {
    font-size: 1.5rem;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    color: var(--color-primary-900);
  }
  
  .article-content :global(h3) {
    font-size: 1.25rem;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    color: var(--color-primary-800);
  }
  
  .article-content :global(ul),
  .article-content :global(ol) {
    margin-bottom: 1.5rem;
    padding-left: 1.5rem;
  }
  
  .article-content :global(li) { margin-bottom: 0.5rem; }
  
  .article-content :global(.cta-box) {
    background: var(--color-neutral-100);
    border-left: 4px solid var(--color-accent-500);
    padding: 2rem;
    margin: 2rem 0;
    border-radius: 0 1rem 1rem 0;
  }
  
  .article-content :global(.cta-box h3) {
    margin-top: 0;
    margin-bottom: 0.5rem;
  }
  
  .article-content :global(.cta-box p) { margin-bottom: 1rem; }
  
  /* Tags */
  .post-tags {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.75rem;
    padding: 1.5rem 0;
    border-top: 1px solid var(--color-neutral-200);
    margin-top: 2rem;
  }
  
  .post-tags a {
    padding: 0.25rem 0.75rem;
    background: var(--color-neutral-100);
    color: var(--color-neutral-700);
    font-size: 0.875rem;
    border-radius: 0.25rem;
    transition: all var(--transition-fast);
  }
  
  .post-tags a:hover {
    background: var(--color-primary-100);
    color: var(--color-primary-900);
  }
  
  /* Share */
  .share-section {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1.5rem 0;
    border-top: 1px solid var(--color-neutral-200);
  }
  
  .share-label { font-weight: 600; color: var(--color-neutral-700); }
  .share-buttons { display: flex; gap: 0.5rem; }
  
  .share-btn {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-neutral-200);
    color: var(--color-neutral-700);
    font-size: 0.75rem;
    font-weight: 700;
    border-radius: 50%;
    transition: all var(--transition-fast);
  }
  
  .share-btn.facebook:hover { background: #1877f2; color: white; }
  .share-btn.twitter:hover { background: #000; color: white; }
  .share-btn.linkedin:hover { background: #0077b5; color: white; }
  .share-btn.whatsapp:hover { background: #25D366; color: white; }
  
  /* Back Link */
  .back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem 0;
    font-weight: 600;
    color: var(--color-primary-900);
  }
  
  .back-link:hover { color: var(--color-accent-600); }
  
  /* Sidebar */
  .post-sidebar { display: flex; flex-direction: column; gap: 2rem; }
  
  .sidebar-widget {
    background: var(--color-neutral-50);
    border-radius: 1rem;
    padding: 1.5rem;
  }
  
  .widget-title {
    font-size: 1.125rem;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid var(--color-accent-500);
  }
  
  .author-widget .author-box { display: flex; gap: 1rem; }
  
  .author-avatar {
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-primary-100);
    color: var(--color-primary-900);
    border-radius: 50%;
    flex-shrink: 0;
  }
  
  .author-name { display: block; font-weight: 600; font-size: 1.0625rem; }
  .author-role { font-size: 0.875rem; color: var(--color-neutral-500); }
  .author-bio { font-size: 0.875rem; color: var(--color-neutral-600); margin-top: 0.5rem; line-height: 1.5; }
  
  .sidebar-cta {
    background: linear-gradient(135deg, var(--color-primary-900) 0%, var(--color-primary-700) 100%);
    color: white;
    border-radius: 1rem;
    padding: 1.5rem;
    text-align: center;
  }
  
  .sidebar-cta h3 { color: white; font-size: 1.125rem; margin-bottom: 0.5rem; }
  .sidebar-cta p { color: rgba(255, 255, 255, 0.9); font-size: 0.9375rem; margin-bottom: 1rem; }
  
  .related-list { list-style: none; padding: 0; margin: 0; }
  
  .related-list li {
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--color-neutral-200);
  }
  
  .related-list li:last-child { border-bottom: none; }
  
  .related-list a {
    color: var(--color-neutral-700);
    font-size: 0.9375rem;
    transition: color var(--transition-fast);
  }
  
  .related-list a:hover { color: var(--color-primary-900); }
</style>
